<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>FFMPEG Player </title>
    <style>
      video{
        background: color:red ;
    }
    </style>
</head>



<body>

<!--

<form method="POST" action="/profile-upload-single" enctype="multipart/form-data">
    <div>
        <label>Upload profile picture</label>
        <input type="file" name="profile-file" required accept="video/*"/>
        <video id="video" width="320" height="240" controls style="display: none;">
        </video>
    </div>
    <div>
        <input type="submit" value="Upload" />
    </div>
</form>


<hr>

      <hr>

      <form method="POST" action="/profile-upload-multiple" enctype="multipart/form-data">
          <div>
              <label>Upload multiple profile picture</label>
              <input type="file" name="profile-files" required multiple  />
          </div>
          <div>
              <input type="submit" value="Upload" />
          </div>
      </form>

      <hr>
      -->

<label for="input">Choose a video file to process:</label>
<input type="file" id="input" name="input_video" required multiple accept="video/mp4, video/mov">
<video id="myVideo" width="320" height="240" controls style="display: none;"></video>
<br> <br> <br>
<hr>


<script>



       var videoSource = new Array();
       let videoCount = document.getElementById("input").files.length;
       console.log(videoCount);

        document.getElementById("input").addEventListener("change", function() {
            var nFilesLength = this.files.length;
            console.log(nFilesLength);
            for(nI=0;nI<nFilesLength; nI++){
                console.log(nI);
                console.log(this.files[nI].name);
                var media = URL.createObjectURL(this.files[nI]);
                console.log(media);
                videoSource[nI]= media;
                video.src = media;
                video.style.display = "block";
                video.load();
                video.play();

        }
      });
/*
  for(nI=0;nI<nFilesLength; nI++){
    var video = document.getElementById("myVideo");
    video.src = videoSource[nI];
    video.style.display = "block";
    video.load();
    video.play();
  }
*/
//      document.getElementById("myVideo").addEventListener('ended',myHandler,false);
/*
let key = 0; // global
      function myHandler() {
        key++;
        if(key == (videoCount)){
          key = 0;
          videoPlay(key);
          }
        else{
          videoPlay(key);
          }
        };

        function videoPlay(videoNum)
        {
          videoElement.setAttribute("src",videoSource[videoNum]);
          videoElement.setAttribute("type",'video/mp4');
          videoElement.style.display = "block";
          videoElement.autoplay = true;
          videoElement.load();
          videoElement.play();
        }
*/
/*
var videoSource = new Array();
let key = 0; // global
let videoElement = document.getElementById("myVideo");

//document.getElementById("myVideo").addEventListener('change',myHandler,false);
document.getElementById("input").addEventListener("change", function() {
  var nFilesLength = this.files.length;
  console.log(nFilesLength);
  for(nI=0;nI<nFilesLength; nI++){
    console.log(nI);
    console.log(this.files[nI].name);
    var media = URL.createObjectURL(this.files[nI]);
    console.log(media);
    //videoSource[nI]= media;
    videoElement.setAttribute("src",media);
  }
});

let videoCount = videoSource.length;
console.log(videoCount);

function videoPlay(videoNum)
{
  videoElement.setAttribute("src",videoSource[videoNum]);
  videoElement.setAttribute("type",'video/mp4');
  videoElement.style.display = "block";
  videoElement.autoplay = true;
  videoElement.load();
  videoElement.play();
}


document.getElementById("myVideo").addEventListener('ended',myHandler,false);


function myHandler() {
  key++;
  if(key == (videoCount)){
    key = 0;
    videoPlay(key);
    }
  else{
    videoPlay(key);
    }
  };

/*
inp1.onchange = function(){
    source1.src = URL.createObjectURL(inp1.files[0]);
    video1.load();
    // even if it's just a pointer to the real file here
    video1.onended = function(){
        URL.revokeObjectURL(video1.currentSrc);
      };
      //let myVideo1 = document.getElementById('video1');
  }

  inp2.onchange = function(){
      source2.src = URL.createObjectURL(inp2.files[0]);
      video2.load();
      // even if it's just a pointer to the real file here
      video2.onended = function(){
          URL.revokeObjectURL(video2.currentSrc);
        };
        //let myVideo2 = document.getElementById('video2');
    }


    let divs = document.querySelectorAll("div1");
*/
    /*
    if(divs==="inp1")
          var myVideo = document.getElementById("video1");
      else if (Div.id==="inp2") {
          var myVideo = document.getElementById("video2");
      }
    */
/*
    let myVideo2 = document.getElementById('video2');

    myVideo2.addEventListener( "loadedmetadata", function (e) {
        var videoWidth = this.videoWidth,
        videoHeight = this.videoHeight;
        console.log(videoWidth);
        console.log(videoHeight);

    }, false );
*/
/*
  var myVideo = document.getElementById("video1");

function playPause() {
  if (myVideo.paused)
    myVideo.play();
  else
    myVideo.pause();
}

function makeBig() {
    myVideo.width = 560;
}

function makeSmall() {
    myVideo.width = 320;
}

function makeNormal() {
    myVideo.width = 420;
}

*/

</script>

<script> src="client.js" </script>

</body>



</html>
